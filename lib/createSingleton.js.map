{"version":3,"file":"createSingleton.js","sources":["../src-js/utils.js","../src-js/dom-utils.js","../src-js/validation.js","../src-js/addons/createSingleton.js"],"sourcesContent":["export function hasOwnProperty(obj, key) {\n    return {}.hasOwnProperty.call(obj, key);\n}\nexport function getValueAtIndexOrReturn(value, index, defaultValue) {\n    if (Array.isArray(value)) {\n        const v = value[index];\n        return v == null\n            ? Array.isArray(defaultValue)\n                ? defaultValue[index]\n                : defaultValue\n            : v;\n    }\n    return value;\n}\nexport function isType(value, type) {\n    const str = {}.toString.call(value);\n    return str.indexOf('[object') === 0 && str.indexOf(`${type}]`) > -1;\n}\nexport function invokeWithArgsOrReturn(value, args) {\n    return typeof value === 'function' ? value(...args) : value;\n}\nexport function debounce(fn, ms) {\n    // Avoid wrapping in `setTimeout` if ms is 0 anyway\n    if (ms === 0) {\n        return fn;\n    }\n    let timeout;\n    return (arg) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => {\n            fn(arg);\n        }, ms);\n    };\n}\nexport function removeProperties(obj, keys) {\n    const clone = Object.assign({}, obj);\n    keys.forEach((key) => {\n        delete clone[key];\n    });\n    return clone;\n}\nexport function splitBySpaces(value) {\n    return value.split(/\\s+/).filter(Boolean);\n}\nexport function normalizeToArray(value) {\n    return [].concat(value);\n}\nexport function pushIfUnique(arr, value) {\n    if (arr.indexOf(value) === -1) {\n        arr.push(value);\n    }\n}\nexport function appendPxIfNumber(value) {\n    return typeof value === 'number' ? `${value}px` : value;\n}\nexport function unique(arr) {\n    return arr.filter((item, index) => arr.indexOf(item) === index);\n}\nexport function getNumber(value) {\n    return typeof value === 'number' ? value : parseFloat(value);\n}\nexport function getBasePlacement(placement) {\n    return placement.split('-')[0];\n}\nexport function arrayFrom(value) {\n    return [].slice.call(value);\n}\nexport function removeUndefinedProps(obj) {\n    return Object.keys(obj).reduce((acc, key) => {\n        if (obj[key] !== undefined) {\n            acc[key] = obj[key];\n        }\n        return acc;\n    }, {});\n}\n","import { arrayFrom, isType, normalizeToArray, getBasePlacement } from './utils';\nexport function div() {\n    return document.createElement('div');\n}\nexport function isElement(value) {\n    return ['Element', 'Fragment'].some((type) => isType(value, type));\n}\nexport function isNodeList(value) {\n    return isType(value, 'NodeList');\n}\nexport function isMouseEvent(value) {\n    return isType(value, 'MouseEvent');\n}\nexport function isReferenceElement(value) {\n    return !!(value && value._tippy && value._tippy.reference === value);\n}\nexport function getArrayOfElements(value) {\n    if (isElement(value)) {\n        return [value];\n    }\n    if (isNodeList(value)) {\n        return arrayFrom(value);\n    }\n    if (Array.isArray(value)) {\n        return value;\n    }\n    return arrayFrom(document.querySelectorAll(value));\n}\nexport function setTransitionDuration(els, value) {\n    els.forEach((el) => {\n        if (el) {\n            el.style.transitionDuration = `${value}ms`;\n        }\n    });\n}\nexport function setVisibilityState(els, state) {\n    els.forEach((el) => {\n        if (el) {\n            el.setAttribute('data-state', state);\n        }\n    });\n}\nexport function getOwnerDocument(elementOrElements) {\n    var _a;\n    const [element] = normalizeToArray(elementOrElements);\n    // Elements created via a <template> have an ownerDocument with no reference to the body\n    return ((_a = element === null || element === void 0 ? void 0 : element.ownerDocument) === null || _a === void 0 ? void 0 : _a.body) ? element.ownerDocument : document;\n}\nexport function isCursorOutsideInteractiveBorder(popperTreeData, event) {\n    const { clientX, clientY } = event;\n    return popperTreeData.every(({ popperRect, popperState, props }) => {\n        const { interactiveBorder } = props;\n        const basePlacement = getBasePlacement(popperState.placement);\n        const offsetData = popperState.modifiersData.offset;\n        if (!offsetData) {\n            return true;\n        }\n        const topDistance = basePlacement === 'bottom' ? offsetData.top.y : 0;\n        const bottomDistance = basePlacement === 'top' ? offsetData.bottom.y : 0;\n        const leftDistance = basePlacement === 'right' ? offsetData.left.x : 0;\n        const rightDistance = basePlacement === 'left' ? offsetData.right.x : 0;\n        const exceedsTop = popperRect.top - clientY + topDistance > interactiveBorder;\n        const exceedsBottom = clientY - popperRect.bottom - bottomDistance > interactiveBorder;\n        const exceedsLeft = popperRect.left - clientX + leftDistance > interactiveBorder;\n        const exceedsRight = clientX - popperRect.right - rightDistance > interactiveBorder;\n        return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;\n    });\n}\nexport function updateTransitionEndListener(box, action, listener) {\n    const method = `${action}EventListener`;\n    // some browsers apparently support `transition` (unprefixed) but only fire\n    // `webkitTransitionEnd`...\n    ['transitionend', 'webkitTransitionEnd'].forEach((event) => {\n        box[method](event, listener);\n    });\n}\n/**\n * Compared to xxx.contains, this function works for dom structures with shadow\n * dom\n */\nexport function actualContains(parent, child) {\n    var _a, _b;\n    let target = child;\n    while (target) {\n        if (parent.contains(target)) {\n            return true;\n        }\n        target = (_b = (_a = target.getRootNode) === null || _a === void 0 ? void 0 : _a.call(target)) === null || _b === void 0 ? void 0 : _b.host;\n    }\n    return false;\n}\n","export function createMemoryLeakWarning(method) {\n    const txt = method === 'destroy' ? 'n already-' : ' ';\n    return [\n        `${method}() was called on a${txt}destroyed instance. This is a no-op but`,\n        'indicates a potential memory leak.',\n    ].join(' ');\n}\nexport function clean(value) {\n    const spacesAndTabs = /[ \\t]{2,}/g;\n    const lineStartWithSpaces = /^[ \\t]*/gm;\n    return value\n        .replace(spacesAndTabs, ' ')\n        .replace(lineStartWithSpaces, '')\n        .trim();\n}\nfunction getDevMessage(message) {\n    return clean(`\n  %ctippy.js\n\n  %c${clean(message)}\n\n  %c👷‍ This is a development-only message. It will be removed in production.\n  `);\n}\nexport function getFormattedMessage(message) {\n    return [\n        getDevMessage(message),\n        // title\n        'color: #00C584; font-size: 1.3em; font-weight: bold;',\n        // message\n        'line-height: 1.5',\n        // footer\n        'color: #a6a095;',\n    ];\n}\n// Assume warnings and errors never have the same message\nlet visitedMessages;\nif (__DEV__) {\n    resetVisitedMessages();\n}\nexport function resetVisitedMessages() {\n    visitedMessages = new Set();\n}\nexport function warnWhen(condition, message) {\n    if (condition && !visitedMessages.has(message)) {\n        visitedMessages.add(message);\n        console.warn(...getFormattedMessage(message));\n    }\n}\nexport function errorWhen(condition, message) {\n    if (condition && !visitedMessages.has(message)) {\n        visitedMessages.add(message);\n        console.error(...getFormattedMessage(message));\n    }\n}\nexport function validateTargets(targets) {\n    const didPassFalsyValue = !targets;\n    const didPassPlainObject = Object.prototype.toString.call(targets) === '[object Object]' &&\n        !targets.addEventListener;\n    errorWhen(didPassFalsyValue, [\n        'tippy() was passed',\n        '`' + String(targets) + '`',\n        'as its targets (first) argument. Valid types are: String, Element,',\n        'Element[], or NodeList.',\n    ].join(' '));\n    errorWhen(didPassPlainObject, [\n        'tippy() was passed a plain object which is not supported as an argument',\n        'for virtual positioning. Use props.getReferenceClientRect instead.',\n    ].join(' '));\n}\n","import tippy from '..';\nimport { div } from '../dom-utils';\nimport { normalizeToArray, removeProperties } from '../utils';\nimport { errorWhen } from '../validation';\nimport { applyStyles } from '@popperjs/core';\n// The default `applyStyles` modifier has a cleanup function that gets called\n// every time the popper is destroyed (i.e. a new target), removing the styles\n// and causing transitions to break for singletons when the console is open, but\n// most notably for non-transform styles being used, `gpuAcceleration: false`.\nconst applyStylesModifier = Object.assign(Object.assign({}, applyStyles), { effect({ state }) {\n        const initialStyles = {\n            popper: {\n                position: state.options.strategy,\n                left: '0',\n                top: '0',\n                margin: '0',\n            },\n            arrow: {\n                position: 'absolute',\n            },\n            reference: {},\n        };\n        Object.assign(state.elements.popper.style, initialStyles.popper);\n        state.styles = initialStyles;\n        if (state.elements.arrow) {\n            Object.assign(state.elements.arrow.style, initialStyles.arrow);\n        }\n        // intentionally return no cleanup function\n        // return () => { ... }\n    } });\nconst createSingleton = (tippyInstances, optionalProps = {}) => {\n    var _a;\n    /* istanbul ignore else */\n    if (__DEV__) {\n        errorWhen(!Array.isArray(tippyInstances), [\n            'The first argument passed to createSingleton() must be an array of',\n            'tippy instances. The passed value was',\n            String(tippyInstances),\n        ].join(' '));\n    }\n    let individualInstances = tippyInstances;\n    let references = [];\n    let triggerTargets = [];\n    let currentTarget;\n    let overrides = optionalProps.overrides;\n    let interceptSetPropsCleanups = [];\n    let shownOnCreate = false;\n    function setTriggerTargets() {\n        triggerTargets = individualInstances\n            .map((instance) => normalizeToArray(instance.props.triggerTarget || instance.reference))\n            .reduce((acc, item) => acc.concat(item), []);\n    }\n    function setReferences() {\n        references = individualInstances.map((instance) => instance.reference);\n    }\n    function enableInstances(isEnabled) {\n        individualInstances.forEach((instance) => {\n            if (isEnabled) {\n                instance.enable();\n            }\n            else {\n                instance.disable();\n            }\n        });\n    }\n    function interceptSetProps(singleton) {\n        return individualInstances.map((instance) => {\n            const originalSetProps = instance.setProps;\n            instance.setProps = (props) => {\n                originalSetProps(props);\n                if (instance.reference === currentTarget) {\n                    singleton.setProps(props);\n                }\n            };\n            return () => {\n                instance.setProps = originalSetProps;\n            };\n        });\n    }\n    // have to pass singleton, as it maybe undefined on first call\n    function prepareInstance(singleton, target) {\n        const index = triggerTargets.indexOf(target);\n        // bail-out\n        if (target === currentTarget) {\n            return;\n        }\n        currentTarget = target;\n        const overrideProps = (overrides || [])\n            .concat('content')\n            .reduce((acc, prop) => {\n            acc[prop] = individualInstances[index].props[prop];\n            return acc;\n        }, {});\n        singleton.setProps(Object.assign(Object.assign({}, overrideProps), { getReferenceClientRect: typeof overrideProps.getReferenceClientRect === 'function'\n                ? overrideProps.getReferenceClientRect\n                : () => { var _a; return (_a = references[index]) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect(); } }));\n    }\n    enableInstances(false);\n    setReferences();\n    setTriggerTargets();\n    const plugin = {\n        fn() {\n            return {\n                onDestroy() {\n                    enableInstances(true);\n                },\n                onHidden() {\n                    currentTarget = null;\n                },\n                onClickOutside(instance) {\n                    if (instance.props.showOnCreate && !shownOnCreate) {\n                        shownOnCreate = true;\n                        currentTarget = null;\n                    }\n                },\n                onShow(instance) {\n                    if (instance.props.showOnCreate && !shownOnCreate) {\n                        shownOnCreate = true;\n                        prepareInstance(instance, references[0]);\n                    }\n                },\n                onTrigger(instance, event) {\n                    prepareInstance(instance, event.currentTarget);\n                },\n            };\n        },\n    };\n    const singleton = tippy(div(), Object.assign(Object.assign({}, removeProperties(optionalProps, ['overrides'])), { plugins: [plugin, ...(optionalProps.plugins || [])], triggerTarget: triggerTargets, popperOptions: Object.assign(Object.assign({}, optionalProps.popperOptions), { modifiers: [\n                ...(((_a = optionalProps.popperOptions) === null || _a === void 0 ? void 0 : _a.modifiers) || []),\n                applyStylesModifier,\n            ] }) }));\n    const originalShow = singleton.show;\n    singleton.show = (target) => {\n        originalShow();\n        // first time, showOnCreate or programmatic call with no params\n        // default to showing first instance\n        if (!currentTarget && target == null) {\n            return prepareInstance(singleton, references[0]);\n        }\n        // triggered from event (do nothing as prepareInstance already called by onTrigger)\n        // programmatic call with no params when already visible (do nothing again)\n        if (currentTarget && target == null) {\n            return;\n        }\n        // target is index of instance\n        if (typeof target === 'number') {\n            return (references[target] && prepareInstance(singleton, references[target]));\n        }\n        // target is a child tippy instance\n        if (individualInstances.indexOf(target) >= 0) {\n            const ref = target.reference;\n            return prepareInstance(singleton, ref);\n        }\n        // target is a ReferenceElement\n        if (references.indexOf(target) >= 0) {\n            return prepareInstance(singleton, target);\n        }\n    };\n    singleton.showNext = () => {\n        const first = references[0];\n        if (!currentTarget) {\n            return singleton.show(0);\n        }\n        const index = references.indexOf(currentTarget);\n        singleton.show(references[index + 1] || first);\n    };\n    singleton.showPrevious = () => {\n        const last = references[references.length - 1];\n        if (!currentTarget) {\n            return singleton.show(last);\n        }\n        const index = references.indexOf(currentTarget);\n        const target = references[index - 1] || last;\n        singleton.show(target);\n    };\n    const originalSetProps = singleton.setProps;\n    singleton.setProps = (props) => {\n        overrides = props.overrides || overrides;\n        originalSetProps(props);\n    };\n    singleton.setInstances = (nextInstances) => {\n        enableInstances(true);\n        interceptSetPropsCleanups.forEach((fn) => fn());\n        individualInstances = nextInstances;\n        enableInstances(false);\n        setReferences();\n        setTriggerTargets();\n        interceptSetPropsCleanups = interceptSetProps(singleton);\n        singleton.setProps({ triggerTarget: triggerTargets });\n    };\n    interceptSetPropsCleanups = interceptSetProps(singleton);\n    return singleton;\n};\nexport default createSingleton;\n"],"names":["removeProperties","obj","keys","clone","Object","assign","forEach","key","normalizeToArray","value","concat","div","document","createElement","clean","spacesAndTabs","lineStartWithSpaces","replace","trim","getDevMessage","message","getFormattedMessage","visitedMessages","resetVisitedMessages","Set","errorWhen","condition","has","add","console","error","applyStylesModifier","applyStyles","effect","state","initialStyles","popper","position","options","strategy","left","top","margin","arrow","reference","elements","style","styles","createSingleton","tippyInstances","optionalProps","_a","Array","isArray","String","join","individualInstances","references","triggerTargets","currentTarget","overrides","interceptSetPropsCleanups","shownOnCreate","setTriggerTargets","map","instance","props","triggerTarget","reduce","acc","item","setReferences","enableInstances","isEnabled","enable","disable","interceptSetProps","singleton","originalSetProps","setProps","prepareInstance","target","index","indexOf","overrideProps","prop","getReferenceClientRect","getBoundingClientRect","plugin","fn","onDestroy","onHidden","onClickOutside","showOnCreate","onShow","onTrigger","event","tippy","plugins","popperOptions","modifiers","originalShow","show","ref","showNext","first","showPrevious","last","length","setInstances","nextInstances"],"mappings":"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"}